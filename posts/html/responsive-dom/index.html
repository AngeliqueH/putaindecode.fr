<!DOCTYPE html><html lang="fr"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width, init-scale=1.0, minimal-ui"><title>Responsive webdesign et structure du DOM</title><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@putaindecode"/><meta name="twitter:title" content="Responsive webdesign et structure du DOM"/><meta name="twitter:creator" content="@_neemzy"/><meta name="twitter:image" content="http://www.gravatar.com/avatar/259cfb842be0d236e68340b1c330cc88.png?s=200"/><meta property="og:title" content="Responsive webdesign et structure du DOM"/><meta property="og:type" content="article"/><meta property="og:image" content="http://www.gravatar.com/avatar/259cfb842be0d236e68340b1c330cc88.png?s=200"/><meta property="og:site_name" content="Putain de code !"/><link rel="stylesheet" href="../../../stylesheets/index.css"><link rel="alternate" href="../../../feed.xml" title="Putain de code !" type="application/atom+xml"></head><body><svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="putainde-Icon-bookmark" viewBox="0 0 512 512">
      <title>bookmark icon</title>
      <path d="M318.275 90v283.23l-62.275-55.07-62.275 55.07v-283.23h124.55m40-40h-204.55v412l102.275-90.443 102.275 90.443v-412z"/>
    </symbol>

    <symbol id="putainde-Icon-github" viewBox="0 0 512 512">
      <title>github icon</title>
      <path d="M461.633 250.645l.367-3.819c-22.896-2.221-45.667-2.419-67.79-.73 3.557-11.347 5.43-24.164 5.295-38.739-.292-30.965-10.616-55.081-26.843-75.096 3.116-18.852.769-37.702-5.111-56.561-23.187 1.898-44.053 9.493-62.634 22.686-34.725-7.044-69.447-7.493-104.172 0-21.673-14.627-42.956-21.802-63.909-22.686-6.21 20.765-7.169 41.233-1.917 61.357-18.28 19.397-25.268 42.944-24.925 69.019.196 14.927 2.496 28.209 6.738 39.952-21.796-1.599-44.201-1.386-66.732.798l.367 3.819c22.947-2.228 45.76-2.411 67.919-.678.814 1.974 1.633 3.939 2.567 5.815-24.009-.633-45.618 1.453-65.854 6.43l.914 3.723c20.538-5.048 42.54-7.081 67.107-6.254 16.246 28.864 47.52 45.824 93.063 51.205-10.581 8.594-16.269 18.731-17.735 30.201h-24.121c-32.394 0-41.226-41.304-74.779-37.229 32.552 16.142 26.052 67.741 78.139 67.741h21.881v47.296c.234 7.643-3.093 12.754-8.469 16.297 18.654 1.884 32.674-7.43 32.674-18.854v-62.518l5.833-6v72.992c.245 7.265-3.284 11.392-7.031 15.339 16.434.654 31.892-2.629 32.592-16.615v-69.857s5.756-3.599 5.756 0v66.58c.169 11.8 10.361 21.367 31.953 19.893-5.776-4.65-7.549-9.35-7.549-16.15v-72.181s5.95-.306 5.95 6v60.881c0 13.55 16.267 19.14 34.829 18.615-6.081-4.558-10.196-9.991-10.223-17.256v-73.217c-.629-10.762-5.003-20.906-13.582-30.358 41.63-6.392 71.637-23.011 86.578-52.796 24.647-.847 46.715 1.183 67.307 6.246l.914-3.723c-20.394-5.014-42.181-7.096-66.416-6.415.839-1.891 1.67-3.789 2.389-5.785 22.39-1.798 45.458-1.622 68.66.632zm-347.633 59.378c-1.023 0-1.853-.588-1.853-1.313 0-.728.83-1.315 1.853-1.315 1.024 0 1.854.588 1.854 1.315 0 .726-.83 1.313-1.854 1.313zm5.833 3.98c-1.137 0-2.06-.653-2.06-1.46s.923-1.462 2.06-1.462 2.059.655 2.059 1.462-.922 1.46-2.059 1.46zm5.917 5.169c-1.333 0-2.415-.766-2.415-1.712s1.082-1.714 2.415-1.714 2.416.768 2.416 1.714-1.083 1.712-2.416 1.712zm5.75 6.207c-1.56 0-2.825-.896-2.825-2.003s1.265-2.005 2.825-2.005 2.825.898 2.825 2.005-1.265 2.003-2.825 2.003zm6.333 7.015c-1.733 0-3.139-.996-3.139-2.226s1.406-2.228 3.139-2.228 3.139.998 3.139 2.228-1.406 2.226-3.139 2.226zm7.334 7.123c-1.926 0-3.488-1.107-3.488-2.474s1.562-2.476 3.488-2.476c1.925 0 3.487 1.109 3.487 2.476s-1.562 2.474-3.487 2.474zm9.916 6.774c-2.14 0-3.875-1.231-3.875-2.749 0-1.519 1.735-2.751 3.875-2.751s3.875 1.232 3.875 2.751c0 1.518-1.735 2.749-3.875 2.749zm12.292 3.625c-2.14 0-3.875-1.231-3.875-2.749 0-1.519 1.735-2.751 3.875-2.751s3.875 1.232 3.875 2.751c0 1.518-1.735 2.749-3.875 2.749zm12.958.417c-2.14 0-3.875-1.231-3.875-2.749 0-1.519 1.735-2.751 3.875-2.751s3.875 1.232 3.875 2.751c0 1.518-1.735 2.749-3.875 2.749zm12.792.25c-2.14 0-3.875-1.231-3.875-2.749 0-1.519 1.735-2.751 3.875-2.751s3.875 1.232 3.875 2.751c0 1.518-1.735 2.749-3.875 2.749z"/>
    </symbol>

    <symbol id="putainde-Icon-home" viewBox="0 0 512 512">
      <title>home icon</title>
      <path d="M394.072 174.805l-47.916-48.023v-38.31h47.916v86.333zm67.928 101.01h-42.508v166.213h-326.984v-166.213h-42.508l206-205.843 206 205.843zm-165.153-3.843c-15.811-3.316-29.021 4.086-38.792 19.387-9.771-15.301-22.98-22.703-38.789-19.387-36.746 10.876-36.336 69.543 38.582 113.047 75.06-43.258 75.742-102.171 38.999-113.047z"/>
    </symbol>

    <symbol id="putainde-Icon-pencil" viewBox="0 0 512 512">
      <title>pencil icon</title>
      <path d="M74.686 340.686l-24.686 120.263 122.365-22.584 207.155-207.154-97.68-97.68-207.154 207.155zm228.402-135.654l-181.891 181.89-21.213-21.213 181.891-181.89 21.213 21.213zm158.912-56.301l-52.662 52.662-97.682-97.68 52.662-52.663 97.682 97.681z"/>
    </symbol>

    <symbol id="putainde-Icon-text-file" viewBox="0 0 512 512">
      <title>text-file icon</title>
      <path d="M256 370.312h-84.495v-30h84.495v30zm83.495-55.416h-167.99v-30h167.99v30zm0-55.334h-167.99v-30h167.99v30zm-41.677-169.562v85.75h85.864v246.25h-255.365v-332h169.501m25-40h-234.501v412h335.365v-311.25l-100.864-100.75z"/>
    </symbol>

    <symbol id="putainde-Icon-twitter" viewBox="0 0 512 512">
      <title>twitter icon</title>
      <path d="M462 128.223c-15.158 6.724-31.449 11.269-48.547 13.31 17.449-10.461 30.854-27.025 37.164-46.764-16.333 9.687-34.422 16.721-53.676 20.511-15.418-16.428-37.386-26.691-61.698-26.691-54.56 0-94.668 50.916-82.337 103.787-70.25-3.524-132.534-37.177-174.223-88.314-22.142 37.983-11.485 87.691 26.158 112.85-13.854-.438-26.891-4.241-38.285-10.574-.917 39.162 27.146 75.781 67.795 83.949-11.896 3.237-24.926 3.978-38.17 1.447 10.754 33.58 41.972 58.018 78.96 58.699-35.537 27.849-80.295 40.288-125.141 35.003 37.406 23.982 81.837 37.977 129.571 37.977 156.932 0 245.595-132.551 240.251-251.435 16.517-11.917 30.846-26.804 42.178-43.755z"/>
    </symbol>
</svg><div class="putainde-Header"><div class="Grid"><div class="Grid-cell u-size5of12"><a href="../../.." class="putainde-SiteTitle"><img alt="Putain de code !" src="../../../images/p!-logo.svg" class="putainde-Logo"><span>Putain de code !</span></a></div><div class="Grid-cell u-size7of12"><nav class="putainde-Nav"><a href="../.." data-rcp-tooltip="" class="putainde-Nav-item  "><svg style="" class="putainde-Icon putainde-Icon-bookmark"><use xlink:href="#putainde-Icon-bookmark"></use></svg> Articles</a><a href="../../../c-est-quoi-putaindecode" data-rcp-tooltip="" class="putainde-Nav-item  "><svg style="" class="putainde-Icon putainde-Icon-text-file"><use xlink:href="#putainde-Icon-text-file"></use></svg> Readme</a><a href="../../comment-contribuer" data-rcp-tooltip="" class="putainde-Nav-item  "><svg style="" class="putainde-Icon putainde-Icon-pencil"><use xlink:href="#putainde-Icon-pencil"></use></svg> Participer</a><a href="https://github.com/putaindecode/" data-rcp-tooltip="GitHub" class="putainde-Nav-item  putainde-Nav-item--icon rcp-Tooltip rcp-Tooltip--bottom"><svg style="" class="putainde-Icon putainde-Icon-github"><use xlink:href="#putainde-Icon-github"></use></svg></a><a href="https://twitter.com/putaindecode/" data-rcp-tooltip="Twitter" class="putainde-Nav-item  putainde-Nav-item--icon rcp-Tooltip rcp-Tooltip--bottom"><svg style="" class="putainde-Icon putainde-Icon-twitter"><use xlink:href="#putainde-Icon-twitter"></use></svg></a></nav></div></div></div><div class="putainde-Main"><article class="Grid putainde-Post"><div class="Grid-cell u-size8of12 Grid putainde-Post-contents"><div class="putainde-Title"><h1 class="putainde-Title-text">Responsive webdesign et structure du DOM</h1></div><header class="putainde-Post-header"><div class="putainde-Post-metas">Écrit par <a href="http://www.zaibatsu.fr">neemzy</a>,<span class="putainde-Date"> le 26 déc. 2013</span>. <span data-rcp-tooltip="Temps de lecture approximatif, sur une base de {{wpm}} mots par minute" data-readingTime-wpm="250" class="putainde-Post-readingTime putainde-Post-readingTime--hidden rcp-Tooltip rcp-Tooltip--top rcp-Tooltip--nowrap">Temps de lecture : environ  <span class="putainde-Post-readingTime-value"></span> minutes</span></div><ul class="putainde-Tags putainde-Post-tags"><li class="putainde-Tag">responsive</li><li class="putainde-Tag">html</li><li class="putainde-Tag">javascript</li></ul></header><div class="putainde-Post-md"><p>Bien, commençons par le commencement, si tu veux bien. Le <strong>responsive
webdesign</strong>, ça te dit quelque chose ? Oui ? Bon. Dans ce cas, tu as peut-être
comme moi déjà été confronté à un cas de figure plutôt ennuyeux. Que tu sois
adepte du <em>mobile-first</em> ou irréductible dégradateur progressiste, il est
forcément arrivé un moment où tu t’es dit cette chose toute bête :</p>
<blockquote>
<p>Ce serait quand même pas mal si cet élément était ici plutôt que là. Sauf que
non.</p>
</blockquote>
<p>Le cas typique est celui d’un menu un minimum complexe, dont on réordonnerait
volontiers les éléments un chouïa au dessus ou en deçà d’une certaine taille
d’écran. Et là, il faut bien avouer qu’il n’existe pas vraiment de solution
miracle.</p>
<p>J’entends déjà les plus teigneux vociférer qu’avec une meilleure réflexion en
amont, le <em>markup</em> aurait été mieux conçu et on n’en serait pas là. Bien qu’un
peu facile, cette réponse peut s’avérer vraie dans un certain nombre de cas
(admire la phrase du mec qui ne se mouille pas). Mais quoi qu’il en soit, si tu
en es au stade de ce type de questionnement, c’est qu’il est de toute façon trop
tard pour faire machine arrière.</p>
<p>Au train où va l’innovation dans notre branche, surtout pour tout ce qui touche
au mobile en général et à la conception web en particulier, il n’est pas exclu
que les bouts de ficelle que je vais t’exposer ici soient obsolètes dans six
mois, et que cet article fasse un comeback incroyable sur Twitter, les RT
moquant gentiment les techniques précolombiennes auxquelles nous étions réduits
il n’y a encore pas si longtemps. Va savoir, je pourrais bien faire l’objet
d’une célébrité paradoxalement décadente à la Rick Astley. En attendant, il
s’agit des seules solutions que je connais pour ce type de cas. Si tu as mieux à
proposer, je te recommande chaudement de l’ouvrir dans les commentaires pour
qu’on en bénéficie tous. C’est bon, on y va ? Je t’attends, moi !</p>
<h2 id="a-l-ancienne-do-repeat-yourself"><a class="putainde-Title-anchor" href="#a-l-ancienne-do-repeat-yourself">#</a>À l’ancienne : Do Repeat Yourself</h2><p>Imagine une page de blog, où apparaissent consécutivement le titre de l’article,
la photo l’illustrant, et enfin le texte. Comme une photo, selon la qualité de
ta connexion, ça peut être un peu galère à charger sur mobile (et que la
question des images en responsive design
<a href="http://css-tricks.com/responsive-images-hard/">est encore un sacré bordel</a>), tu
prends la décision de passer la photo en dessous du contenu textuel pour que tes
visiteurs puissent lire leur article peinards même si la photo n’a pas fini de
charger - et tu vas même en profiter pour la remplacer par une version plus
light.</p>
<p>Dans un tel cas, la meilleure solution peut encore être de dupliquer ta balise
<code>img</code>, et de masquer l’une ou l’autre avec CSS en fonction de la taille d’écran,
grâce à une <code>media query</code>. Voilà un exemple rudimentaire :</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">article</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Mon super article<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">img</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"/mon/image/desktop.jpg"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"img-desktop"</span> /&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>Lâche tes comm' !<span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">img</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"/mon/image/mobile.jpg"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"img-mobile"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">article</span>&gt;</span>
</code></pre>
<pre><code class="lang-css"><span class="hljs-class">.img-desktop</span> <span class="hljs-rules">{
  <span class="hljs-comment">/* Par défaut, l'image desktop est cachée */</span>
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> none</span></span>;
<span class="hljs-rule">}</span></span>

<span class="hljs-at_rule">@<span class="hljs-keyword">media</span> screen and (min-width: <span class="hljs-number">768px</span>) </span>{
  <span class="hljs-comment">/* Si on est sur "grand" écran, on affiche l'image desktop... */</span>
  <span class="hljs-class">.img-desktop</span> <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> block</span></span>;
  <span class="hljs-rule">}</span></span>

  <span class="hljs-comment">/* ...et on masque l'image mobile */</span>
  <span class="hljs-class">.img-mobile</span> <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> none</span></span>;
  <span class="hljs-rule">}</span></span>
}
</code></pre>
<p>Évidemment, le gros inconvénient de ce type de solution est que qui dit
duplication de contenu dit augmentation du poids total. Dans le cas d’un contenu
purement textuel, selon sa taille, cela peut être négligeable. J’ai ici
volontairement pris l’exemple le moins adapté : une image, qu’il ne faut
absolument pas faire charger deux fois à nos visiteurs. On va tricher un peu
avec JavaScript :</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">article</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Mon super article<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- Ces images ne seront pas chargées car elles n'ont pas d'attribut src --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">img</span> <span class="hljs-attribute">data-src</span>=<span class="hljs-value">"/mon/image/desktop.jpg"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"img-desktop"</span> /&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>Lâche tes comm' !<span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">img</span> <span class="hljs-attribute">data-src</span>=<span class="hljs-value">"/mon/image/mobile.jpg"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"img-mobile"</span> /&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">noscript</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Cette image ne sera chargée que si le visiteur n'a pas activé le JS --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">img</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"/mon/image/mobile.jpg"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"img-mobile img-noscript"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">noscript</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">article</span>&gt;</span>
</code></pre>
<pre><code class="lang-css"><span class="hljs-class">.img-desktop</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> none</span></span>;
<span class="hljs-rule">}</span></span>

<span class="hljs-at_rule">@<span class="hljs-keyword">media</span> screen and (min-width: <span class="hljs-number">768px</span>) </span>{
  <span class="hljs-class">.img-desktop</span> <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> block</span></span>;
  <span class="hljs-rule">}</span></span>

  <span class="hljs-class">.img-mobile</span> <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> none</span></span>;
  <span class="hljs-rule">}</span></span>
}

<span class="hljs-class">.img-noscript</span> <span class="hljs-rules">{
  <span class="hljs-comment">/* On surcharge le style desktop pour s'assurer
     que cette image s'affiche quelle que soit la taille de l'écran */</span>

  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> block</span></span>;
<span class="hljs-rule">}</span></span>
</code></pre>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> handleImages = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// On charge les images ayant l'attribut data-src,</span>
  <span class="hljs-comment">// non encore chargées (attribut src indéfini)</span>
  <span class="hljs-comment">// et non masquées par CSS</span>

  [].forEach.call(<span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'img[data-src]:not([src])'</span>), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.getComputedStyle(el).display != <span class="hljs-string">'none'</span>) {
      el.src = el.getAttribute(<span class="hljs-string">'data-src'</span>);
    }
  });
};

<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'load'</span>, handleImages);
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'resize'</span>, handleImages);
</code></pre>
<p>Ainsi, seules les images nécessaires seront chargées avec la page. J’applique
également le même traitement au <code>resize</code> ; c’est un peu bourrin, je te
l’accorde, on pourrait probablement faire plus fin avec <code>matchMedia</code>.</p>
<p>Dans le cas d’un visiteur naviguant sans JavaScript, seule l’image mobile est
chargée : je pars du principe qu’étant donné qu’on ne peut pas définir laquelle
des deux versions de l’image est la mieux adaptée pour lui, autant lui envoyer
la plus légère.</p>
<h2 id="js-powa-enquire-js"><a class="putainde-Title-anchor" href="#js-powa-enquire-js">#</a>JS powa : enquire.js</h2><p>La seconde solution peut tout à fait être réalisée “à la main”, mais je vais te
parler d’une petite librairie que j’aime beaucoup et que j’ai déjà utilisée dans
ce genre de cas. Elle se nomme <a href="http://wicky.nillia.ms/enquire.js/">enquire.js</a>
et permet tout simplement d’affecter des callbacks à des media queries :</p>
<pre><code class="lang-javascript">enquire.register(<span class="hljs-string">'screen and (min-width: 768px)'</span>, {
  match: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// L'écran fait 768px de large ou plus...</span>
  },

  unmatch: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// ...et ici, 767px de large ou moins.</span>
    <span class="hljs-comment">// La librairie repose sur matchMedia et matchMedia.addListener</span>
  }
});
</code></pre>
<p>Plutôt sympa, non ? Pour reprendre notre exemple de tout à l’heure (le CSS n’est
plus nécessaire) :</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">article</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Mon super article<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">img</span> <span class="hljs-attribute">data-src</span>=<span class="hljs-value">"/mon/image/desktop.jpg"</span> <span class="hljs-attribute">data-mobile-src</span>=<span class="hljs-value">"/mon/image/mobile.jpg"</span> /&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>Lâche tes comm' !<span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">noscript</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">img</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"/mon/image/mobile.jpg"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">noscript</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">article</span>&gt;</span>
</code></pre>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> content = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'p'</span>),

  switchImage = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(isMobile)</span> </span>{
    <span class="hljs-keyword">var</span> attr = isMobile ? <span class="hljs-string">'data-mobile-src'</span> : <span class="hljs-string">'data-src'</span>;

    [].forEach.call(<span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'img['</span> + attr + <span class="hljs-string">']'</span>), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
      <span class="hljs-comment">// On affecte l'une ou l'autre source à notre image,</span>
      <span class="hljs-comment">// entraînant son chargement si nécessaire.</span>
      el.src = el.getAttribute(attr);

      <span class="hljs-comment">// On en profite pour la bouger avant ou après le contenu</span>
      content.parentNode.insertBefore(el, isMobile ? content.nextSibling : content);
    });
  };

enquire.register(<span class="hljs-string">'screen and (min-width: 768px)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  switchImage(<span class="hljs-literal">false</span>);
});

enquire.register(<span class="hljs-string">'screen and (max-width: 767px)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  switchImage(<span class="hljs-literal">true</span>);
});
</code></pre>
<p>On peut ainsi gérer facilement le chargement de l’image, ainsi que son
emplacement. J’utilise ici deux handlers distincts pour m’assurer qu’enquire
fait bien son boulot au chargement aussi, dans tous les cas (les callbacks
<code>unmatch</code> ne sont appelés qu’au redimensionnement, semble-t-il : avec un seul
handler, l’image n’arrive donc jamais si on charge la page avec un écran d’une
largeur inférieure à 768px).</p>
<h2 id="that-s-all-you-ve-got-bitch-"><a class="putainde-Title-anchor" href="#that-s-all-you-ve-got-bitch-">#</a>That’s all you’ve got, bitch?</h2><p>On peut également, puisque tu y tiens tant, évoquer d’autres solutions plus
marginales mais qui méritent d’être citées.</p>
<h3 id="foundation"><a class="putainde-Title-anchor" href="#foundation">#</a>Foundation</h3><p><a href="http://foundation.zurb.com/">Foundation</a> propose, dans sa version 5 (et
peut-être même avant, j’ai pas vérifié) un peu de sucre syntaxique HTML
permettant de switcher (via JS, œuf corse) simplement entre différents contenus
pour l’élément sur lequel on l’utilise.</p>
<p>C’est pas mal. Ça donne ça (tiré de <a href="http://foundation.zurb.com/docs/components/interchange.html">la doc</a>) :</p>
<blockquote>
<p>We use the data-interchange attribute on a markup container (probably a div)
to do this. Here’s an example which loads up a small, static map on mobile, a
larger static map for medium-sized devices, and a full interactive Google map
on large display devices.</p>
</blockquote>
<pre><code class="lang-html">&lt;<span class="hljs-keyword">div</span> data-interchange=<span class="hljs-string">"[../examples/interchange/default.html, (small)],
                       [../examples/interchange/medium.html, (medium)],
                       [../examples/interchange/large.html, (large)]"</span>&gt;
  &lt;<span class="hljs-keyword">div</span> data-alert <span class="hljs-type">class</span>=<span class="hljs-string">"alert-box secondary radius"</span>&gt;
    This <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> default content.
    &lt;a href=<span class="hljs-string">"#"</span> <span class="hljs-type">class</span>=<span class="hljs-string">"close"</span>&gt;&amp;<span class="hljs-keyword">times</span>;&lt;/a&gt;
  &lt;/<span class="hljs-keyword">div</span>&gt;
&lt;/<span class="hljs-keyword">div</span>&gt;
</code></pre>
<p><code>small</code>, <code>medium</code> et <code>large</code> étant des raccourcis pour des media queries données
(c’est dans <a href="http://foundation.zurb.com/docs/components/interchange.html">la doc</a>,
toujours. J’insiste.)</p>
<h3 id="flexbox-pas-toi-david-"><a class="putainde-Title-anchor" href="#flexbox-pas-toi-david-">#</a>Flexbox (pas toi, David)</h3><p>On peut également, comme l’a très justement souligné <a href="/#crew">lionelB</a>, se
pencher (mais pas trop) sur le cas de Flexbox, qui est un nouveau type de
positionnement introduit en CSS3. La <a href="http://caniuse.com/#search=flexbox">compatibilité</a>
n’est pas encore au top (surtout grâce à IE, qui l’eût cru) mais autant se tenir
prêts ! Pour ceux qui ont dormi, en gros, tu définis un conteneur :</p>
<pre><code class="lang-css"><span class="hljs-class">.flex-container</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> flex</span></span>;

  <span class="hljs-comment">/* ou bien */</span>

  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-flex</span></span>;
<span class="hljs-rule">}</span></span>
</code></pre>
<p>…et tu donnes des numéros à ses enfants, comme à Bangkok :</p>
<pre><code class="lang-css"><span class="hljs-class">.title</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">order</span>:<span class="hljs-value"> <span class="hljs-number">1</span></span></span>;
<span class="hljs-rule">}</span></span>

<span class="hljs-class">.content</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">order</span>:<span class="hljs-value"> <span class="hljs-number">2</span></span></span>;
<span class="hljs-rule">}</span></span>

<span class="hljs-class">.image</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">order</span>:<span class="hljs-value"> <span class="hljs-number">3</span></span></span>;
<span class="hljs-rule">}</span></span>

<span class="hljs-comment">/*
Bien sûr, tu as été assez malin pour mettre ton image en dernier dans le DOM...
...n'est-ce pas ?
*/</span>

<span class="hljs-at_rule">@<span class="hljs-keyword">media</span> screen and (min-width: <span class="hljs-number">768px</span>) </span>{
  <span class="hljs-class">.content</span> <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">order</span>:<span class="hljs-value"> <span class="hljs-number">3</span></span></span>;
  <span class="hljs-rule">}</span></span>

  <span class="hljs-class">.image</span> <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">order</span>:<span class="hljs-value"> <span class="hljs-number">2</span></span></span>;
  <span class="hljs-rule">}</span></span>
}
</code></pre>
<p>Et voilà, pas besoin d’avoir fait Pollypocket pour percevoir à quel point la
flexibilité et la propreté du code que cette technique nous permet d’écrire
résolvent notre problème en deux secondes douze. Ce n’est évidemment ici que la
partie émergée du flexberg ; il y a des tas de bonnes ressources qui vous
expliqueront ça en long, en large et en travers bien mieux que moi, notamment
<a href="http://www.adobe.com/devnet/html5/articles/working-with-flexbox-the-new-spec.html">cet article</a>
sur lequel j’ai honteusement pompé les snippets de cette partie.</p>
<h2 id="conclusion"><a class="putainde-Title-anchor" href="#conclusion">#</a>Conclusion</h2><p>Comme tu l’as vu, rien de ce que je t’ai montré n’est réellement satisfaisant :
pour pouvoir contrôler le positionnement d’un élément dans le DOM dans le cadre
d’un webdesign responsive, tu dois soit le dupliquer et jouer à cache-cache,
soit le déplacer avec JavaScript. Aussi, je serais ravi que tu partages ton
opinion, tes idées ou tes retours d’XP à ce sujet. Ça me fera de la lecture pour
passer le temps, et toi tu feras quelque chose de constructif !</p>
<p>Il est temps pour moi de te laisser reprendre le cours de ta vie. Peut-être nos
routes se croiseront-elles de nouveau. Dans l’intervalle, va, vis, et code !</p>
</div><footer class="putainde-Post-footer"><div class="putainde-Post-footer-title">Action sur cette page</div><div class="Grid"><div class="Grid-cell u-size1of3"><a href="http://github.com/putaindecode/website/edit/master/pages/posts/html/responsive-dom/index.md" class="putainde-Post-footer-action">Modifier</a></div><div class="Grid-cell u-size1of3"><a href="http://github.com/putaindecode/website/blame/master/pages/posts/html/responsive-dom/index.md" class="putainde-Post-footer-action">Tracer les changements</a></div><div class="Grid-cell u-size1of3"><a href="http://github.com/putaindecode/website/commits/master/pages/posts/html/responsive-dom/index.md" class="putainde-Post-footer-action">Historique</a></div></div></footer><div class="putainde-Author"><a href="http://www.zaibatsu.fr" data-rcp-tooltip="neemzy" class="putainde-Author-picture "><img src="http://www.gravatar.com/avatar/259cfb842be0d236e68340b1c330cc88.png" alt="" class="putainde-Avatar js-AnimateLoad"/></a><div class="putainde-Author-description"><div class="putainde-Author-title"><h3 class="putainde-Author-name"><span class="putainde-WrittenBy">Écrit par</span> <a href="http://www.zaibatsu.fr" class="putainde-Link">neemzy</a></h3><div class="putainde-Author-social"><a href="http://www.zaibatsu.fr" data-rcp-tooltip="Website" class="rcp-Tooltip rcp-Tooltip--top"><svg style="" class="putainde-Icon putainde-Icon-home"><use xlink:href="#putainde-Icon-home"></use></svg></a><a href="https://twitter.com/_neemzy" data-rcp-tooltip="Twitter" class="rcp-Tooltip rcp-Tooltip--top"><svg style="" class="putainde-Icon putainde-Icon-twitter"><use xlink:href="#putainde-Icon-twitter"></use></svg></a><a href="https://github.com/neemzy" data-rcp-tooltip="Github" class="rcp-Tooltip rcp-Tooltip--top"><svg style="" class="putainde-Icon putainde-Icon-github"><use xlink:href="#putainde-Icon-github"></use></svg></a></div></div><p class="putainde-Author-bio">Développeur full-stack tombé dans le web quand il était petit. <br> Fait surtout du PHP, mais aussi de plus en plus de JavaScript. <br> A une peur irraisonnée des utilisateurs de Mac / Ruby / Sass. <br> Atteint du syndrome de Patrick Modiano qui l'empêche parfois de finir ses</p></div></div><div id="disqus_thread" aria-live="polite"><noscript>| Please enable JavaScript to view the
a(href="http://disqus.com/?ref_noscript") comments powered by Disqus.</noscript></div></div></article></div><div class="putainde-Footer"><div class="Grid"><div class="Grid-cell u-size3of12"><p class="putainde-Footer-text">© 1970 - 2014 Putain de Code !</p></div><div class="Grid-cell u-size6of12"><ul class="putainde-Footer-list"><li></li><li><a href="../../../feed.xml">Flux RSS</a></li><li><a href="../../../projets">Projets</a></li><li><a href="https://github.com/putaindecode/forum/issues">Forum</a></li><li><a href="irc://irc.freenode.net/putaindecode">IRC</a></li><a href="https://github.com/putaindecode/" data-rcp-tooltip="GitHub" class="rcp-Tooltip rcp-Tooltip--top"><svg style="" class="putainde-Icon putainde-Icon-github"><use xlink:href="#putainde-Icon-github"></use></svg></a><a href="https://twitter.com/putaindecode/" data-rcp-tooltip="Twitter" class="rcp-Tooltip rcp-Tooltip--top"><svg style="" class="putainde-Icon putainde-Icon-twitter"><use xlink:href="#putainde-Icon-twitter"></use></svg></a></ul></div><div class="Grid-cell u-size3of12"><p class="putainde-Footer-text putainde-Footer-text--small putainde-Footer-text--right">Made with ♥︎ by <a href="../../../#crew">le crew</a></p></div></div></div><script>var disqus_shortname = "putaindecode";var disqus_identifier = "http://putaindecode.fr/posts/html/responsive-dom/";
var disqus_url = "http://putaindecode.fr/posts/html/responsive-dom/";
var disqus_script = "embed.js";;(function(d,s) {
s = d.createElement('script');s.async=1;s.src = '//' + disqus_shortname + '.disqus.com/'+disqus_script;
(d.getElementsByTagName('head')[0]).appendChild(s)
})(document)</script><script src="../../../scripts/index.js"></script><script>var _gaq=[['_setAccount','UA-43771806-1'],['_trackPageview']];
(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
g.src='//www.google-analytics.com/ga.js';
s.parentNode.insertBefore(g,s)}(document,'script'));</script></body></html>